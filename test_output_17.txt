
> task-manager-backend@1.0.0 test
> jest tests/unit/admin.service.test.js

  console.log
    [dotenv@17.2.3] injecting env (22) from .env -- tip: ≡ƒæÑ sync secrets across teammates & machines: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

node.exe : FAIL 
tests/unit/admin.service.test.js (7.442 s)
At C:\Program Files\nodejs\npm.ps1:29 char:3
+   & $NODE_EXE $NPM_CLI_JS $args
+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified:  
   (FAIL tests/unit...st.js (7.442 s):Strin  
  g) [], RemoteException
    + FullyQualifiedErrorId : NativeCommandE 
   rror
 
  AdminService
    login
      ΓêÜ should successfully login with 
valid credentials (34 ms)
      ΓêÜ should throw error for invalid 
credentials (2 ms)
      ΓêÜ should throw error for 
non-existent admin (2 ms)
      ΓêÜ should lock account after 5 failed 
attempts (3 ms)
      ΓêÜ should handle remember me option 
correctly (6 ms)
    refreshToken
      ΓêÜ should refresh tokens with valid 
refresh token (8 ms)
      ΓêÜ should throw error for invalid 
refresh token (3 ms)
      ΓêÜ should throw error for expired 
refresh token (4 ms)
      ΓêÜ should throw error for token 
version mismatch (4 ms)
      ΓêÜ should throw error for locked 
account (3 ms)
      ΓêÜ should increment token version on 
refresh (9 ms)
    updateProfile
      ├ù should update admin profile 
successfully (2 ms)
      ΓêÜ should throw error for duplicate 
email (2 ms)
      ├ù should allow same email for same 
admin (2 ms)
    forgotPassword
      ΓêÜ should generate and send OTP for 
valid admin (2 ms)
      ΓêÜ should throw error for 
non-existent admin (1 ms)
      ΓêÜ should handle locked account (2 ms)

  ΓùÅ AdminService ΓÇ║ updateProfile ΓÇ║ 
should update admin profile successfully

    TypeError: Cannot read properties of 
undefined (reading 'error')

    [0m [90m 48 |[39m       
[33mLogger[39m[33m.[39minfo([32m`Cache 
Invalidated: ${key}`[39m)[33m;[39m
     [90m 49 |[39m     } [36mcatch[39m 
(error) {
    [31m[1m>[22m[39m[90m 50 |[39m      
 
[33mLogger[39m[33m.[39merror([32m`Cache 
Delete Error: ${key}`[39m[33m,[39m { 
error[33m:[39m 
error[33m?[39m[33m.[39mmessage 
[33m||[39m error })[33m;[39m
     [90m    |[39m              
[31m[1m^[22m[39m
     [90m 51 |[39m     }
     [90m 52 |[39m   }
     [90m 53 |[39m[0m

      at Cache.error [as del] 
(src/utils/cache.js:50:14)
      at AdminService.del [as 
invalidateAdminCache] 
(src/services/admin.service.js:45:17)
      at AdminService.invalidateAdminCache 
[as updateProfile] 
(src/services/admin.service.js:349:16)
      at Object.<anonymous> 
(tests/unit/admin.service.test.js:299:22)

  ΓùÅ AdminService ΓÇ║ updateProfile ΓÇ║ 
should allow same email for same admin

    TypeError: Cannot read properties of 
undefined (reading 'error')

    [0m [90m 48 |[39m       
[33mLogger[39m[33m.[39minfo([32m`Cache 
Invalidated: ${key}`[39m)[33m;[39m
     [90m 49 |[39m     } [36mcatch[39m 
(error) {
    [31m[1m>[22m[39m[90m 50 |[39m      
 
[33mLogger[39m[33m.[39merror([32m`Cache 
Delete Error: ${key}`[39m[33m,[39m { 
error[33m:[39m 
error[33m?[39m[33m.[39mmessage 
[33m||[39m error })[33m;[39m
     [90m    |[39m              
[31m[1m^[22m[39m
     [90m 51 |[39m     }
     [90m 52 |[39m   }
     [90m 53 |[39m[0m

      at Cache.error [as del] 
(src/utils/cache.js:50:14)
      at AdminService.del [as 
invalidateAdminCache] 
(src/services/admin.service.js:45:17)
      at AdminService.invalidateAdminCache 
[as updateProfile] 
(src/services/admin.service.js:349:16)
      at Object.<anonymous> 
(tests/unit/admin.service.test.js:331:22)

Test Suites: 1 failed, 1 total
Tests:       2 failed, 15 passed, 17 total
Snapshots:   0 total
Time:        7.63 s
Ran all test suites matching 
/tests\\unit\\admin.service.test.js/i.
